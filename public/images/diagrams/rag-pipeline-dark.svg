<svg viewBox="0 0 520 380" width="100%" height="auto" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="RAG Pipeline: Query to Embed to Retrieve to Augment to Generate">
  <defs>
    <filter id="shadow" x="-4%" y="-4%" width="108%" height="112%">
      <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000000" flood-opacity="0.3"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="520" height="380" rx="16" fill="#1a1d23" stroke="#2d3139" stroke-width="1.5"/>
  <text x="260" y="28" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="11" font-weight="700" letter-spacing="2.5" fill="#64748b">RAG PIPELINE</text>

  <!-- Row 1 -->
  <!-- Step 1: User Query -->
  <rect x="18" y="50" width="142" height="90" rx="12" fill="rgba(99,102,241,0.1)" stroke="#818cf8" stroke-width="1.8" filter="url(#shadow)"/>
  <text x="89" y="82" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="13" font-weight="700" fill="#a5b4fc">USER QUERY</text>
  <text x="89" y="100" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="9.5" fill="#a5b4fc" opacity="0.8">"Who founded…"</text>
  <circle cx="89" cy="124" r="11" fill="rgba(99,102,241,0.15)" stroke="#818cf8" stroke-width="1.5"/>
  <text x="89" y="128.5" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="10" font-weight="700" fill="#a5b4fc">1</text>

  <!-- Arrow 1→2 -->
  <path d="M160,95 L182,95" fill="none" stroke="#818cf8" stroke-width="2.5" stroke-linecap="round"/>
  <polygon points="196,95 182,88 182,102" fill="#818cf8"/>

  <!-- Step 2: Embed -->
  <rect x="200" y="50" width="120" height="90" rx="12" fill="rgba(139,92,246,0.1)" stroke="#a78bfa" stroke-width="1.8" filter="url(#shadow)"/>
  <text x="260" y="82" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="13" font-weight="700" fill="#c4b5fd">EMBED</text>
  <text x="260" y="100" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="9.5" fill="#c4b5fd" opacity="0.8">text-embedding-3</text>
  <circle cx="260" cy="124" r="11" fill="rgba(139,92,246,0.15)" stroke="#a78bfa" stroke-width="1.5"/>
  <text x="260" y="128.5" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="10" font-weight="700" fill="#c4b5fd">2</text>

  <!-- Arrow 2→3 -->
  <path d="M320,95 L342,95" fill="none" stroke="#a78bfa" stroke-width="2.5" stroke-linecap="round"/>
  <polygon points="356,95 342,88 342,102" fill="#a78bfa"/>

  <!-- Step 3: Vector Search -->
  <rect x="360" y="50" width="142" height="90" rx="12" fill="rgba(59,130,246,0.1)" stroke="#60a5fa" stroke-width="1.8" filter="url(#shadow)"/>
  <text x="431" y="76" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="13" font-weight="700" fill="#93c5fd">VECTOR</text>
  <text x="431" y="92" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="13" font-weight="700" fill="#93c5fd">SEARCH</text>
  <text x="431" y="110" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="9.5" fill="#93c5fd" opacity="0.8">top-k similar chunks</text>
  <circle cx="431" cy="124" r="11" fill="rgba(59,130,246,0.15)" stroke="#60a5fa" stroke-width="1.5"/>
  <text x="431" y="128.5" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="10" font-weight="700" fill="#93c5fd">3</text>

  <!-- Curved L-arrow: Step 3 ↓ → Step 4 -->
  <path d="M431,140 L431,178 Q431,192 417,192 L336,192" fill="none" stroke="#60a5fa" stroke-width="2.5" stroke-linecap="round"/>
  <polygon points="322,192 336,185 336,199" fill="#60a5fa"/>

  <!-- Row 2 -->
  <!-- Step 4: Augment -->
  <rect x="200" y="168" width="120" height="90" rx="12" fill="rgba(245,158,11,0.1)" stroke="#fbbf24" stroke-width="1.8" filter="url(#shadow)"/>
  <text x="260" y="202" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="13" font-weight="700" fill="#fcd34d">AUGMENT</text>
  <text x="260" y="220" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="9.5" fill="#fcd34d" opacity="0.8">context + question</text>
  <circle cx="260" cy="242" r="11" fill="rgba(245,158,11,0.15)" stroke="#fbbf24" stroke-width="1.5"/>
  <text x="260" y="246.5" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="10" font-weight="700" fill="#fcd34d">4</text>

  <!-- Arrow 4→5 -->
  <path d="M200,213 L178,213" fill="none" stroke="#fbbf24" stroke-width="2.5" stroke-linecap="round"/>
  <polygon points="164,213 178,206 178,220" fill="#fbbf24"/>

  <!-- Step 5: Generate -->
  <rect x="18" y="168" width="142" height="90" rx="12" fill="rgba(16,185,129,0.1)" stroke="#34d399" stroke-width="1.8" filter="url(#shadow)"/>
  <text x="89" y="200" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="13" font-weight="700" fill="#6ee7b7">GENERATE</text>
  <text x="89" y="218" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="9.5" fill="#6ee7b7" opacity="0.8">LLM produces</text>
  <text x="89" y="232" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="9.5" fill="#6ee7b7" opacity="0.8">grounded answer</text>
  <circle cx="89" cy="242" r="11" fill="rgba(16,185,129,0.15)" stroke="#34d399" stroke-width="1.5"/>
  <text x="89" y="246.5" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="10" font-weight="700" fill="#6ee7b7">5</text>

  <!-- Offline indexing note -->
  <rect x="18" y="290" width="484" height="68" rx="12" fill="#22252b" stroke="#2d3139" stroke-width="1.2"/>
  <text x="260" y="316" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="11.5" font-weight="600" fill="#94a3b8">Offline Indexing (runs once / on update)</text>
  <text x="260" y="338" text-anchor="middle" font-family="ui-sans-serif,system-ui,sans-serif" font-size="10" fill="#64748b">Documents → Chunk → Embed → Store in Vector DB</text>
</svg>
